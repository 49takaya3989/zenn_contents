---
title: "MUI + React Hook Form ã« Vitest ã‚’ä½¿ã£ã¦ãƒ†ã‚¹ãƒˆå°å…¥"
emoji: "ğŸ¡"
type: "tech"
topics:
  - "reacthookform"
  - "mui"
  - "vitets"
published: true
published_at: "2024-03-23 01:38"
---

# ã¯ã˜ã‚ã«
ä»Šå›ã®ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰â†“
https://github.com/49takaya3989/sample_react_mui_react-hook-form/tree/main/src/MUI%2BRHF_with_controller_and_zod

# é–‹ç™ºç’°å¢ƒ
```json
"@hookform/resolvers": "^3.3.4",
"@mui/material": "^5.15.10",
"@mui/x-date-pickers": "^6.19.4",
"react-hook-form": "^7.50.1",
"@testing-library/jest-dom": "^6.4.2",
"@testing-library/react": "^14.2.1",
"@testing-library/user-event": "^14.5.2",
"@vitest/coverage-v8": "^1.3.1",
"vitest": "^1.3.0"
```

# MUI + React Hook Form ã§ãƒ•ã‚©ãƒ¼ãƒ ä½œæˆ
â†“ã“ã¡ã‚‰ã®è¨˜äº‹ã§ç´¹ä»‹ã—ã¦ã„ã‚‹ã®ã§å‚è€ƒã«ã•ã‚Œã¦ãã ã•ã„ã€‚
https://zenn.dev/takaya39/articles/8b9ce75259a791

# Vitest ã®ç‰¹å¾´
> - Viteã®è¨­å®šã€ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒãƒ¼ã€ãƒªã‚¾ãƒ«ãƒãƒ¼ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã€‚
> - ã‚¢ãƒ—ãƒªã‹ã‚‰åŒã˜è¨­å®šã‚’ä½¿ç”¨ã—ã¦ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
> - ãƒ†ã‚¹ãƒˆç”¨ã® HMR ãªã©ã€ã‚¹ãƒãƒ¼ãƒˆã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ãƒˆãªã‚¦ã‚©ãƒƒãƒ ãƒ¢ãƒ¼ãƒ‰!
> - Vueã€Reactã€Svelteã€Litã€Marko ãªã©ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ãƒ†ã‚¹ãƒˆ
> - ã™ãã«ä½¿ãˆã‚‹ TypeScript / JSX ã®ã‚µãƒãƒ¼ãƒˆ
> - ESM ãŒæœ€åˆã€ãƒˆãƒƒãƒ—ãƒ¬ãƒ™ãƒ«ãŒå¾…æ©Ÿ
> - Tinypoolã‚’ä»‹ã—ãŸãƒ¯ãƒ¼ã‚«ãƒ¼ã®ãƒãƒ«ãƒã‚¹ãƒ¬ãƒƒãƒ‰åŒ–
> - Tinybenchã«ã‚ˆã‚‹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã®ã‚µãƒãƒ¼ãƒˆ
> - ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã€ã‚¹ã‚¤ãƒ¼ãƒˆã¨ãƒ†ã‚¹ãƒˆã®åŒæ™‚å®Ÿè¡Œ
> - ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®ã‚µãƒãƒ¼ãƒˆ
> - Jestäº’æ›ã®ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆ
> - ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ç”¨ã®Chaiçµ„ã¿è¾¼ã¿ + Jest ã¯äº’æ›æ€§ã®ã‚ã‚‹ APIã‚’æœŸå¾…ã—ã¾ã™
> - ãƒ¢ãƒƒã‚¯ç”¨ã®Tinyspyçµ„ã¿è¾¼ã¿
> - DOM ãƒ¢ãƒƒã‚¯ç”¨ã®happy-domã¾ãŸã¯jsdom
> - v8ã¾ãŸã¯istanbulã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ ã‚«ãƒãƒ¬ãƒƒã‚¸
> - Rustã®ã‚ˆã†ãªã‚½ãƒ¼ã‚¹å†…ãƒ†ã‚¹ãƒˆ
> - Expect-typeã«ã‚ˆã‚‹å‹ãƒ†ã‚¹ãƒˆ

https://vitest.dev/guide/features.html

# Vitestã®å°å…¥
[å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://vitest.dev/guide/)ã‚’å‚è€ƒã«å®Ÿæ–½
1. å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
2. package.jsonã«scriptã®è¿½åŠ 
3. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
4. ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰

## å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```node
npm install -D vitest @testing-library/jest-dom @testing-library/react @testing-library/user-event
```
@testing-library/jest-dom: domã®çŠ¶æ…‹ç¢ºèªãªã©ã§ä½¿ç”¨
@testing-library/react: domã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã®ã«ä½¿ç”¨
@testing-library/user-event: è¤‡æ•°ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ›¸ããŸã‚ã«ä½¿ç”¨
## package.jsonã«scriptã®è¿½åŠ 
```json:package.json
{
  "scripts": {
    ...
    "test": "vitest",
    "test:coverage": "vitest run --coverage"
  }
}
```

## ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
ãƒ†ã‚¹ãƒˆã«é–¢ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’importã‚’ã—ãªãã¦ã‚‚ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹ãŸã‚ã«ã€è¨­å®šã‚’è¡Œã†ã€‚
```ts:vite.config.ts
export default defineConfig({
  test: {
    ãƒ»ãƒ»ãƒ»
    globals: true,
  },
})
```
```json:tsconfig.json
{
  "compilerOptions": {
    ãƒ»ãƒ»ãƒ»
    "types": ["vitest/globals"]
  },
}
```

ãƒ†ã‚¹ãƒˆã§domçŠ¶æ…‹ã®æ“ä½œãŒã§ãã‚‹è¨­å®šã‚’è¡Œã†ã€‚
```ts:vite.config.ts
export default defineConfig({
  test: {
    ãƒ»ãƒ»ãƒ»
    environment: 'jsdom',
    setupFiles: ['[setup.ts ãŒç½®ã‹ã‚Œã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ‘ã‚¹]/setup.ts']
  },
})
```
```ts:setup.ts
import '@testing-library/jest-dom';
import { cleanup } from "@testing-library/react";
import { afterEach } from "vitest";

// ãƒ†ã‚¹ãƒˆã®å‰¯ä½œç”¨ã‚’é˜²ãã€å„ãƒ†ã‚¹ãƒˆãŒäº’ã„ã«ç‹¬ç«‹ã—ã¦å®Ÿè¡Œã™ã‚‹ãŸã‚ã« clean up ã™ã‚‹
afterEach(() => {
  cleanup();
});
```
å¿…è¦æœ€ä½é™ã®è¨­å®šã¯ã“ã‚Œã§OKï¼

## ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰
è©¦ã—ã«ã€åˆæœŸçŠ¶æ…‹ã®æ™‚ã«é€ä¿¡ãƒœã‚¿ãƒ³ãŒéæ´»æ€§ã«ãªã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ã¿ã‚‹ã€‚
```ts:index.test.tsx
import {render, screen} from '@testing-library/react'
import MuiRhfWithControllerAndZod from './index';

describe('ãƒœã‚¿ãƒ³ã®æ´»æ€§éæ´»æ€§', () => {
  it('æœªå…¥åŠ›ã®ã¨ã', async () => {
    render(<MuiRhfWithControllerAndZod />)
    screen.debug();
    expect(screen.getByTestId('formButton')).toBeDisabled();
  });
})
```
â€»`it`ã¯`test`ã¨æ›¸ã„ã¦ã‚‚åŒã˜çµæœã«ãªã‚‹

`npm run test`ã‚’å©ã„ã¦ã¿ã¦ã€ä¸‹è¨˜ã®ã‚ˆã†ãªçµæœã«ãªã‚Œã°æˆåŠŸï¼
```node
stdout | src/MUI+RHF_with_controller_and_zod/__test__/index.test.tsx > ãƒœã‚¿ãƒ³ã®æ´»æ€§éæ´»æ€§ > æœªå…¥åŠ›ã®ã¨ã
<body>
  ãƒ»ãƒ»ãƒ» index.tsxã®domãŒå‡ºåŠ›ã•ã‚Œã‚‹

 âœ“ src/MUI+RHF_with_controller_and_zod/__test__/index.test.tsx (1)
   âœ“ ãƒœã‚¿ãƒ³ã®æ´»æ€§éæ´»æ€§ (1)
     âœ“ æœªå…¥åŠ›ã®ã¨ã

 Test Files  1 passed (1)
      Tests  1 passed (1)
   Start at  17:42:16
   Duration  1.78s (transform 70ms, setup 202ms, collect 814ms, tests 278ms, environment 340ms, prepare 50ms)


 PASS  Waiting for file changes...
       press h to show help, press q to quit
```

ä»Šå›æ›¸ã„ã¦ã¿ã‚ˆã†ã¨æ€ã£ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§ã¯ä¸‹è¨˜ã®é€šã‚Š
- åˆæœŸçŠ¶æ…‹
    - é€ä¿¡ãƒœã‚¿ãƒ³ãŒéæ´»æ€§
    - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå…¨ã¦éè¡¨ç¤º
- å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®è¡¨ç¤º
    - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®éè¡¨ç¤º
- é€ä¿¡
    - é€ä¿¡ã§ãã‚‹
 
:::details ã‚³ãƒ¼ãƒ‰
```tsx
import { render, screen, within } from '@testing-library/react'
import userEvent, { UserEvent } from '@testing-library/user-event'
import MuiRhfWithControllerAndZod from '../index'
import { errorMessage } from '../schema'

describe('åˆæœŸçŠ¶æ…‹', () => {
  beforeEach(() => {
    render(<MuiRhfWithControllerAndZod />)
  })

  it('é€ä¿¡ãƒœã‚¿ãƒ³ãŒéæ´»æ€§', async () => {
    expect(screen.getByTestId('formButton')).toBeDisabled()
  })

  it('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒå…¨ã¦éè¡¨ç¤º', async () => {
    expect(screen.queryByText(errorMessage.text.min)).not.toBeInTheDocument()
    expect(
      screen.queryByText(errorMessage.number.refine.isRequired)
    ).not.toBeInTheDocument()
    expect(
      screen.queryByText(errorMessage.number.refine.isPositive)
    ).not.toBeInTheDocument()
    expect(screen.queryByText(errorMessage.select.min)).not.toBeInTheDocument()
    expect(
      screen.queryByText(errorMessage.checkbox.refine.isChecked)
    ).not.toBeInTheDocument()
    expect(
      screen.queryByText(errorMessage.checkboxes.refine.isAtLeastOne)
    ).not.toBeInTheDocument()
    expect(screen.queryByText(errorMessage.radio.min)).not.toBeInTheDocument()
    expect(screen.queryByText(errorMessage.date.min)).not.toBeInTheDocument()
    expect(
      screen.queryByText(errorMessage.date.refine.isFutureDate)
    ).not.toBeInTheDocument()
    expect(
      screen.queryByText(errorMessage.textarea.min)
    ).not.toBeInTheDocument()
  })
})

describe('å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³', () => {
  describe('ãƒ†ã‚­ã‚¹ãƒˆ', () => {
    describe('ãƒ©ãƒ™ãƒ«ï¼šãƒ†ã‚­ã‚¹ãƒˆ', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('å…¥åŠ›å¾Œã€å€¤ã‚’å‰Šé™¤ã—ã¦ã‚‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('nullAbleText')

        await user.click(inputEl)
        await user.tab()
        expect(
          screen.queryByText(errorMessage.text.min)
        ).not.toBeInTheDocument()
      })
    })

    describe('ãƒ©ãƒ™ãƒ«ï¼šãƒ†ã‚­ã‚¹ãƒˆï¼ˆå¿…é ˆï¼‰', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('å…¥åŠ›å¾Œã€å€¤ã‚’å‰Šé™¤ã—ã€focus ã‚’å¤–ã™ã¨ã€å¿…é ˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('text')

        await user.click(inputEl)
        await user.tab()
        expect(screen.queryByText(errorMessage.text.min)).toBeInTheDocument()
      })
      it('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€1æ–‡å­—ä»¥ä¸Šå…¥åŠ›ã—ã€focus ã‚’å¤–ã™ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒéè¡¨ç¤ºã«ãªã‚‹', async () => {
        const inputEl = screen.getByTestId('text')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.text.min)
        ).toBeInTheDocument()
        await user.type(inputEl, 't')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.text.min)
        ).not.toBeInTheDocument()
      })
    })
  })

  describe('æ•°å€¤', () => {
    describe('ãƒ©ãƒ™ãƒ«ï¼šæ•°å€¤', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('focus ã‚’å¤–ã™ã€ã‚‚ã—ãã¯ 0 ã‚’å…¥åŠ›ã—ã¦ã‚‚ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('nullAbleNumber')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isRequired)
        ).not.toBeInTheDocument()

        await user.type(inputEl, '0')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isPositive)
        ).not.toBeInTheDocument()
      })
    })

    describe('ãƒ©ãƒ™ãƒ«ï¼šæ•°å€¤ï¼ˆå¿…é ˆï¼‰', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('å…¥åŠ›å¾Œã€å€¤ã‚’å‰Šé™¤ã—ã€focus ã‚’å¤–ã™ã¨ã€å¿…é ˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('number')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isRequired)
        ).toBeInTheDocument()
      })
      it('0ã‚’å…¥åŠ›å¾Œã€focus ã‚’å¤–ã™ã¨ã€æ­£ã®æ•´æ•°ç”¨ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('number')

        await user.type(inputEl, '0')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isPositive)
        ).toBeInTheDocument()
      })
      it('è² ã®æ•´æ•°ã‚’å…¥åŠ›å¾Œã€focus ã‚’å¤–ã™ã¨ã€æ­£ã®æ•´æ•°ç”¨ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('number')

        await user.type(inputEl, '-1')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isPositive)
        ).toBeInTheDocument()
      })
      it('å¿…é ˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€è² ã®æ•´æ•°ã‚’å…¥åŠ›ã—ã€focus ã‚’å¤–ã™ã¨å¿…é ˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒæ­£ã®æ•´æ•°ç”¨ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«å¤‰æ›´ã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('number')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isRequired)
        ).toBeInTheDocument()
        await user.type(inputEl, '0')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isPositive)
        ).toBeInTheDocument()
      })
      it('å¿…é ˆã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€æ­£ã®æ•´æ•°ã‚’å…¥åŠ›ã—ã€focus ã‚’å¤–ã™ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒéè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('number')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isRequired)
        ).toBeInTheDocument()
        await user.type(inputEl, '1')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isPositive)
        ).not.toBeInTheDocument()
      })
      it('æ­£ã®æ•´æ•°ç”¨ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€æ­£ã®æ•´æ•°ã‚’å…¥åŠ›ã—ã€focus ã‚’å¤–ã™ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒéè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('number')

        await user.type(inputEl, '0')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isPositive)
        ).toBeInTheDocument()
        await user.type(inputEl, '1')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.number.refine.isPositive)
        ).not.toBeInTheDocument()
      })
    })
  })

  describe('ã‚»ãƒ¬ã‚¯ãƒˆ', () => {
    describe('ãƒ©ãƒ™ãƒ«ï¼šã‚»ãƒ¬ã‚¯ãƒˆ', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ä»»æ„ã®å€¤ã‚’é¸æŠå¾Œã€"é¸æŠã—ã¦ãã ã•ã„"ã‚’é¸æŠã—ã€ focus ã‚’å¤–ã—ã¦ã‚‚ã¦ã‚‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        // <Select /> ã®ãƒˆãƒªã‚¬ãƒ¼ã¯ combobox
        // è¤‡æ•°ã‚ã‚‹å ´åˆã®ãŸã‚ã« within ã‚’æŒŸã‚€
        const selectBoxEl = within(
          screen.getByTestId('nullAbleSelect')
        ).getByRole('combobox')

        await user.click(selectBoxEl)
        await user.tab()
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.select.min)
        ).not.toBeInTheDocument()
      })
    })

    describe('ãƒ©ãƒ™ãƒ«ï¼šã‚»ãƒ¬ã‚¯ãƒˆï¼ˆå¿…é ˆï¼‰', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ä»»æ„ã®å€¤ã‚’é¸æŠå¾Œã€"é¸æŠã—ã¦ãã ã•ã„"ã‚’é¸æŠã—ã€ focus ã‚’å¤–ã—ãŸã‚‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        // <Select /> ã®ãƒˆãƒªã‚¬ãƒ¼ã¯ combobox
        // è¤‡æ•°ã‚ã‚‹å ´åˆã®ãŸã‚ã« within ã‚’æŒŸã‚€
        const selectBoxEl = within(screen.getByTestId('select')).getByRole(
          'combobox'
        )

        await user.click(selectBoxEl)
        await user.tab()
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.select.min)
        ).toBeInTheDocument()

        await user.click(selectBoxEl)
        await user.click(
          await screen.getByRole('option', { name: 'ã‚»ãƒ¬ã‚¯ãƒˆ1' })
        )
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.select.min)
        ).not.toBeInTheDocument()
        await user.click(selectBoxEl)
        await user.click(
          await screen.getByRole('option', { name: 'é¸æŠã—ã¦ãã ã•ã„' })
        )
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.select.min)
        ).toBeInTheDocument()
      })
      it('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€ä»»æ„ã®å€¤ã‚’é¸æŠå¾Œã€"é¸æŠã—ã¦ãã ã•ã„"ä»¥å¤–ã®ä»»æ„ã®å€¤ã‚’é¸æŠã—ã€ focus ã‚’å¤–ã—ãŸã‚‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        // <Select /> ã®ãƒˆãƒªã‚¬ãƒ¼ã¯ combobox
        // è¤‡æ•°ã‚ã‚‹å ´åˆã®ãŸã‚ã« within ã‚’æŒŸã‚€
        const selectBoxEl = within(screen.getByTestId('select')).getByRole(
          'combobox'
        )

        await user.click(selectBoxEl)
        await user.tab()
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.select.min)
        ).toBeInTheDocument()
        await user.click(selectBoxEl)
        await user.click(
          await screen.getByRole('option', { name: 'ã‚»ãƒ¬ã‚¯ãƒˆ1' })
        )
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.select.min)
        ).not.toBeInTheDocument()
      })
    })
  })

  describe('ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹', () => {
    describe('ãƒ©ãƒ™ãƒ«ï¼šãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('2å›ã‚¯ãƒªãƒƒã‚¯ã—ã€ focus ã‚’å¤–ã—ã¦ã‚‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('nullAbleCheckbox')

        await user.dblClick(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkbox.refine.isChecked)
        ).not.toBeInTheDocument()
      })
    })

    describe('ãƒ©ãƒ™ãƒ«ï¼šãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼ˆå¿…é ˆï¼‰', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('2å›ã‚¯ãƒªãƒƒã‚¯ã—ã€ focus ã‚’å¤–ã™ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('checkbox')

        await user.dblClick(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkbox.refine.isChecked)
        ).toBeInTheDocument()
      })
      it('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€1å›ã‚¯ãƒªãƒƒã‚¯ã—ã€ focus ã‚’å¤–ã—ãŸã‚‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('checkbox')

        await user.dblClick(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkbox.refine.isChecked)
        ).toBeInTheDocument()
        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkbox.refine.isChecked)
        ).not.toBeInTheDocument()
      })
    })
  })

  describe('è¤‡æ•°ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹', () => {
    describe('ãƒ©ãƒ™ãƒ«ï¼šè¤‡æ•°ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ä»»æ„ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’2å›ã‚¯ãƒªãƒƒã‚¯ã—ã€ focus ã‚’å¤–ã—ã¦ã‚‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('nullAbleCheckboxes0')

        await user.dblClick(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkboxes.refine.isAtLeastOne)
        ).not.toBeInTheDocument()
      })
    })

    describe('ãƒ©ãƒ™ãƒ«ï¼šè¤‡æ•°ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ï¼ˆå¿…é ˆï¼‰', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ä»»æ„ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’2å›ã‚¯ãƒªãƒƒã‚¯ã—ã€ focus ã‚’å¤–ã—ã¦ã‚‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('checkboxes0')

        await user.dblClick(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkboxes.refine.isAtLeastOne)
        ).toBeInTheDocument()
      })
      it('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€ä»»æ„ã®ãƒã‚§ãƒƒã‚¯ã‚¹ã‚’1å›ã‚¯ãƒªãƒƒã‚¯ã—ã€ focus ã‚’å¤–ã—ãŸã‚‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('checkboxes0')

        await user.dblClick(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkboxes.refine.isAtLeastOne)
        ).toBeInTheDocument()
        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.checkboxes.refine.isAtLeastOne)
        ).not.toBeInTheDocument()
      })
    })
  })

  describe('æ—¥ç¨‹', () => {
    describe('ãƒ©ãƒ™ãƒ«ï¼šæ—¥ç¨‹', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã„ã¦ã‹ã‚‰é–‰ã˜ã¦ã‚‚ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const calIcon = within(screen.getByTestId('nullAbleDate')).getByRole(
          'button'
        )

        await user.dblClick(calIcon)
        await expect(
          screen.queryByText(errorMessage.date.refine.isFutureDate)
        ).not.toBeInTheDocument()
      })
    })

    describe('ãƒ©ãƒ™ãƒ«ï¼šæ—¥ç¨‹ï¼ˆå¿…é ˆï¼‰', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã„ã¦ã‹ã‚‰é–‰ã˜ã‚‹ã¨ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const calIcon = within(screen.getByTestId('date')).getByRole('button')

        await user.dblClick(calIcon)
        await expect(
          screen.queryByText(errorMessage.date.refine.isFutureDate)
        ).toBeInTheDocument()
      })
      it('éå»æœˆã‚’å…¥åŠ›ã—ãŸã‚‰ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = within(screen.getByTestId('date')).getByRole('textbox')

        await user.type(inputEl, '2024/03/01')
        await expect(
          screen.queryByText(errorMessage.date.refine.isFutureDate)
        ).toBeInTheDocument()
      })
      it('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€æœªæ¥æœˆã‚’å…¥åŠ›å¾Œã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const calIcon = within(screen.getByTestId('date')).getByRole('button')
        const inputEl = within(screen.getByTestId('date')).getByRole('textbox')

        await user.dblClick(calIcon)
        await expect(
          screen.queryByText(errorMessage.date.refine.isFutureDate)
        ).toBeInTheDocument()
        await user.type(inputEl, '2024/04/01')
        await expect(
          screen.queryByText(errorMessage.date.refine.isFutureDate)
        ).not.toBeInTheDocument()
      })
    })
  })

  describe('ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢', () => {
    describe('ãƒ©ãƒ™ãƒ«ï¼šãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ä¸€åº¦ focus ã‚’å½“ã¦ã¦ã€å¤–ã—ã¦ã‚‚ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('nullAbleTextarea')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.textarea.min)
        ).not.toBeInTheDocument()
      })
    })

    describe('ãƒ©ãƒ™ãƒ«ï¼šãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ï¼ˆå¿…é ˆï¼‰', () => {
      let user: UserEvent

      beforeEach(() => {
        user = userEvent.setup()
        render(<MuiRhfWithControllerAndZod />)
      })

      it('ä¸€åº¦ focus ã‚’å½“ã¦ã¦ã€å¤–ã—ãŸã‚‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹', async () => {
        const inputEl = screen.getByTestId('textarea')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.textarea.min)
        ).toBeInTheDocument()
      })
      it('ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹ã§ã€ä»»æ„ã®å€¤ã‚’å…¥åŠ›å¾Œã€ focus ã‚’å¤–ã—ãŸã‚‰ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œãªã„', async () => {
        const inputEl = screen.getByTestId('textarea')

        await user.click(inputEl)
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.textarea.min)
        ).toBeInTheDocument()
        await user.type(inputEl, 'test')
        await user.tab()
        await expect(
          screen.queryByText(errorMessage.textarea.min)
        ).not.toBeInTheDocument()
      })
    })
  })
})

describe('é€ä¿¡', () => {
  let user: UserEvent

  beforeEach(() => {
    user = userEvent.setup()
    render(<MuiRhfWithControllerAndZod />)
  })

  it('é€ä¿¡å®Œäº†å¾Œã€ãƒ•ã‚©ãƒ¼ãƒ ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã¦ã„ã‚‹', async () => {
    const textEl = screen.getByTestId('text')
    const numberEl = screen.getByTestId('number')
    const selectBoxEl = within(screen.getByTestId('select')).getByRole(
      'combobox'
    )
    const checkboxEl = screen.getByTestId('checkbox')
    const multiCheckboxEl = screen.getByTestId('checkboxes0')
    const dateEl = within(screen.getByTestId('date')).getByRole('textbox')
    const radioEl = screen.getByTestId('radio0')
    const textareaEl = screen.getByTestId('textarea')
    const formButtonEl = screen.getByTestId('formButton')

    await user.type(textEl, 'test')
    await user.type(numberEl, '1')
    await user.click(selectBoxEl)
    await user.click(await screen.getByRole('option', { name: 'ã‚»ãƒ¬ã‚¯ãƒˆ1' }))
    await user.click(checkboxEl)
    await user.click(multiCheckboxEl)
    await user.type(dateEl, '2024/04/01')
    await user.click(radioEl)
    await user.type(textareaEl, 'test')
    await user.tab()
    await expect(formButtonEl).not.toBeDisabled()
  })
})
```
:::

ä»¥ä¸Šï¼

å‚è€ƒã«ã—ãŸè¨˜äº‹
https://qiita.com/Adacchi3/items/fc8cf264503aaae8e4d6
https://qiita.com/Yasushi-Mo/items/0a29df164b02bd7d78e6
https://qiita.com/moroball14/items/39e6bca94c3588d78bc8