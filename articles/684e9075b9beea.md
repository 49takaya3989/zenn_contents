---
title: "TypeScriptã®æ©Ÿèƒ½æ—©è¦‹è¡¨"
emoji: "ğŸ‘‹"
type: "tech"
topics:
  - "typescript"
published: true
published_at: "2024-01-08 01:02"
---

ã“ã‚Œã£ã¦ã©ã†ã„ã†ä½¿ã„æ–¹ã‚„ã£ãŸã£ã‘ï¼Ÿã¨ãªã‚ŠãŒã¡ãªã‚‚ã®ã‚’ã¾ã¨ã‚ã¦ãŠããŸã„ã¨æ€ã£ã¦æ›¸ã„ãŸè¨˜äº‹ã§ã™ã€‚
ä»Šå¾Œã‚‚ã“ã‚Œã©ã†ã‚„ã£ãŸã£ã‘ã¨ã‹ã‚ã‚Œã°è¿½åŠ ã—ã¦ã„ãäºˆå®šã§ã™ã€‚
ã“ã‚Œã‚‚è¿½åŠ ã—ã¨ã„ã¦ã»ã—ã„ãªã©ã‚ã‚Œã°ã‚³ãƒ¡ãƒ³ãƒˆã¾ã§ãŠé¡˜ã„ã—ã¾ã™ï¼
# Generics
## Genericsï¼ˆã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã‚¹ï¼‰ã¨ã¯ï¼Ÿ
ã¾ãšã€`Generics`ã¯`TypeScript`ã«é™ã£ãŸæ©Ÿèƒ½ã§ã¯ãªã„ã€‚
`C#`ã‚„`Java`ã¨ã„ã£ãŸè¨€èªã‚‚Genericsã‚’æ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã€‚
`Generics`ã¯æŠ½è±¡çš„ãªå‹å¼•æ•°ï¼ˆã‚ˆããƒ©ã‚¤ãƒ–ãƒ©ãƒªã§è¦‹ã‹ã‘ã‚‹`<T>`ã¿ãŸã„ãªã‚„ã¤ï¼‰ã‚’ä½¿ç”¨ã—ã¦ã€å®Ÿéš›ã«åˆ©ç”¨ã•ã‚Œã‚‹ã¾ã§å‹ãŒç¢ºå®šã—ãªã„`ã‚¯ãƒ©ã‚¹ãƒ»é–¢æ•°ãƒ»ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹`ã‚’å®Ÿç¾ã™ã‚‹ç‚ºã«ä½¿ç”¨ã•ã‚Œã‚‹ã€‚
ã‚‚ã£ã¨ç •ã‘ãŸè¨€ã„æ–¹ã‚’ã™ã‚‹ã¨ã™ã‚Œã°ã€é–¢æ•°ã‚’ä½œã‚‹éš›ã«å¼•æ•°ãŒå¿…è¦ã ã‘ã©ã€`Generics`ã¯å‹ã¾ã§å¼•æ•°ã¨ã—ã¦å–ã£ã¦ã—ã¾ãˆãƒ¼ã£ã¦æ„Ÿã˜ãªã‚„ã¤ã€‚

> å‹ã®å®‰å…¨æ€§ã¨ã‚³ãƒ¼ãƒ‰ã®å…±é€šåŒ–ã®ä¸¡ç«‹ã¯é›£ã—ã„ã‚‚ã®ã§ã™ã€‚ã‚ã‚‰ã‚†ã‚‹å‹ã§åŒã˜ã‚³ãƒ¼ãƒ‰ã‚’ä½¿ãŠã†ã¨ã™ã‚‹ã¨ã€å‹ã®å®‰å…¨æ€§ãŒçŠ ç‰²ã«ãªã‚Šã¾ã™ã€‚é€†ã«ã€å‹ã®å®‰å…¨æ€§ã‚’é‡è¦–ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ã€åŒã˜ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’é‡ç”£ã™ã‚‹å¿…è¦ãŒå‡ºã¦ã‚³ãƒ¼ãƒ‰ã®å…±é€šåŒ–ãŒé”æˆã—ã¥ã‚‰ããªã‚Šã¾ã™ã€‚ã“ã†ã—ãŸå•é¡Œã‚’è§£æ±ºã™ã‚‹ãŸã‚ã«å°å…¥ã•ã‚ŒãŸè¨€èªæ©Ÿèƒ½ãŒã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã§ã™ã€‚ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã‚’ç”¨ã„ã‚‹ã¨ã€å‹ã®å®‰å…¨æ€§ã¨ã‚³ãƒ¼ãƒ‰ã®å…±é€šåŒ–ã‚’ä¸¡ç«‹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

https://typescriptbook.jp/reference/generics

## å…·ä½“ä¾‹
### é–¢æ•°ver
#### å‹å¼•æ•°ãŒï¼‘ã¤
```ts
function hoge<T>(arg: T): T {
  return arg;
}

hoge<number>(1);
// > function hoge<number>(arg: number): number
hoge<string>("fuga");
// > function hoge<string>(arg: string): string

hoge("fuga");
// > function hoge<"fuga">(arg: "fuga"): "fuga"
```
#### å‹å¼•æ•°ãŒè¤‡æ•°
```ts
function hoge<T, U, P>(arg1:T, arg2: U, arg3: P): P {
  return arg3;
}
hoge("foo", true, 4);
// > function hoge<string, boolean, 4>(arg1: string, arg2: boolean, arg3: 4): 4

function fuga<T, U, P, V>(arg1:T, arg2: U, arg3: P): V {
  return arg;
}
fuga("foo", true, 4);
// > function fuga<string, boolean, number, unknown>(arg1: string, arg2: boolean, arg3: number): unknown
```
### ã‚¯ãƒ©ã‚¹ver
```ts
class Klass<T> {
  item: T;

  constructor(item: T) {
    this.item = item;
  }

  getItem(): T {
    return this.item;
  }
}

let newKlass = new Klass<string>("hoge");
newKlass.getItem();
// > let newKlass: Klass<string>
// > (method) Klass<string>.getItem(): string

let newKlass = new Klass<number>(5);
newKlass.getItem();
// > let newKlass: Klass<number>
// > (method) Klass<number>.getItem(): number
```

### ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ver
```
interface Hoge<T, U> {
  foo: T;
  boo: U;
}

let hoge: Hoge<string, number> = {
  foo: "foo",
  boo: 2
}
// > let hoge: Hoge<string, number>
```

å‚è€ƒè¨˜äº‹
https://qiita.com/k-penguin-sato/items/9baa959e8919157afcd4
https://www.typescriptlang.org/docs/handbook/generics.html
https://typescriptbook.jp/reference/generics

# infer
## inferã¨ã¯ï¼Ÿ
Conditional Typesï¼ˆæ¡ä»¶ä»˜ãå‹*ï¼‰ã§ä½¿ç”¨ã™ã‚‹extendså†…ã®æ¨è«–ã•ã‚Œã‚‹å‹ã‚’å°å…¥ã™ã‚‹ãŸã‚ã®å®£è¨€ã€‚
â€»æ¡ä»¶ä»˜ãå‹
â†“ã®ã“ã¨
```ts
T extends U ? X : Y
```
## inferã®ä½¿ã‚ã‚Œæ–¹
### ReturnType
Utility Typesã®ä¸­ã®ReturnTypeãªã©ã§inferãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã€‚
https://www.typescriptlang.org/docs/handbook/utility-types.html#returntypetype
```ts
type ReturnType<T> = T extends (...args: any) => infer R ? R : any;

type Hoge = ReturnType<number>;
// type Hoge = any
type Fuga = ReturnType<() => number>;
// type Hoge = number
```
### Flatten
`T`ãŒé…åˆ—ãªã‚‰ã€ãã®ä¸­èº«ã®å‹ã‚’inferã§æ¨æ¸¬ã—ã€å‹ã¨ã—ã¦å®šç¾©ã™ã‚‹ã€‚
https://www.typescriptlang.org/docs/handbook/2/conditional-types.html#inferring-within-conditional-types
```ts
type Flatten<T> = T extends Array<infer U> ? U : T;

const users = [
  { name: 'a', age: 25 },
  { name: 'b', age: 30 }
]
type obj = Flatten<typeof users>
// type obj = {
//     name: string;
//     age: number;
// }

```
### Unpack
æ¡ä»¶ä»˜ãã‚¿ã‚¤ãƒ—ã‚’ãƒã‚¹ãƒˆã—ã¦ã€æ¬¡ã®é †åºã§è©•ä¾¡ã•ã‚Œã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è‡´ã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’å½¢æˆã™ã‚‹ã€‚
https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html#type-inference-in-conditional-types
```ts
type Unpacked<T> = T extends (infer U)[] ? U
  : T extends (...args: any[]) => infer U ? U
  : T extends Promise<infer U> ? U
  : T;
  
type T0 = Unpacked<string>; // string
type T1 = Unpacked<string[]>; // string
type T2 = Unpacked<() => string>; // string
type T3 = Unpacked<Promise<string>>; // string
type T4 = Unpacked<Promise<string>[]>; // Promise<string>
type T5 = Unpacked<Unpacked<Promise<string>[]>>; // string
```

å‚è€ƒè¨˜äº‹
https://qiita.com/iwata-goq/items/677251ce778afcacd33e
# as const satisfies
## ãã‚‚ãã‚‚satisfiesã£ã¦ãªã«ï¼Ÿ
`å¼ satisfies å‹`
TypeScript4.9ã§å°å…¥ã•ã‚ŒãŸæ›¸ãæ–¹ã€‚
å¼ãŒå‹ã«ãƒãƒƒãƒã™ã‚‹ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã€‚
```ts
type Hoge = {
  foo: string
};

// å‹æ³¨é‡ˆ
const hoge: Hoge = {
  foo: 'foo'
};
// > OK

// satisfies
const hoge = {
  foo: 'foo'
} satisfies Hoge;
// > OK

const hoge = {
  fo: 'foo'
} satisfies Hoge;
// > NG
// > 'fo' ã¯å‹ 'Hoge' ã«å­˜åœ¨ã—ã¾ã›ã‚“

const hoge = {
  foo: 1
} satisfies Hoge;
// > NG
// > å‹ 'number' ã‚’å‹ 'string' ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
```
### å‹æ³¨é‡ˆã¨satisfiesã®é•ã„ã¯ï¼Ÿ
çµæœãŒå‹æ³¨é‡ˆã¨åŒã˜ã§`satisfies`ã£ã¦ãªã‚“ã®ãŸã‚ã«ä½¿ã†ã®ã£ã¦ãªã‚Šãã†ã ã‘ã©ã€
ã€Œå‹æ³¨é‡ˆã€ã¯**æ¨è«–çµæœã‚’ç¶­æŒã§ããªã„**ã®ã«å¯¾ã—ã€Œsatisfiesã€ã¯**æ¨è«–çµæœã‚’ä¿æŒã§ãã‚‹**
```ts
const hoge: Hoge = {
  foo: 'foo'
};
// > const hoge1: Hoge

const hoge = {
  foo: 'foo'
} satisfies Hoge;
// > const hoge2: {
// >     foo: string;
// > }
```
ã‚ˆã‚Šæ©æµãŒã‚ã‹ã‚Šã‚„ã™ã„ã®ã¯ä¸‹è¨˜ã‚³ãƒ¼ãƒ‰ã ã¨æ€ã„ã¾ã™ã€‚
```ts
type ColorList = {
  [key in 'red' | 'green' | 'blue']: unknown
};

const colorList: ColorList = {
  red: 'red',
  green: [0, 255, 0],
  blue: 'blue',
};
colorList.green.map((val) => val * 2);
// NG
// > 'colorList1.green''ã¯ 'unknown' å‹ã§ã™

const colorList = {
  red: 'red',
  green: [0, 255, 0],
  blue: 'blue',
} satisfies ColorList;

colorList.green.map((val) => val * 2);
// OK
```

## ãã‚‚ãã‚‚as constã£ã¦ãªã«ï¼Ÿ
`å¼ as const`
TypeScript3.4ã§å°å…¥ã•ã‚ŒãŸæ›¸ãæ–¹ã€‚
- ãƒªãƒ†ãƒ©ãƒ«å‹ã‚’[widening](https://zenn.dev/estra/articles/typescript-widening)ã—ãªã„
- ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå†…ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒreadonlyã«ãªã‚‹
- é…åˆ—ãƒªãƒ†ãƒ©ãƒ«ã®æ¨è«–çµæœãŒ[ã‚¿ãƒ—ãƒ«å‹](https://typescriptbook.jp/reference/values-types-variables/tuple)ã«ãªã‚‹

```ts
const myArray = [
  'hoge',
  'fuga'
]
// > const myArray: string[]

const myArray = [
  'hoge',
  'fuga'
] as const;
// > const myArray: readonly ["hoge", "fuga"]
```

## ã¾ã¨ã‚
wideningã‚’é˜²æ­¢ã—ã¤ã¤ã€å‹æ¨è«–çµæœã‚’ç¶­æŒã§ãã‚‹ã€‚
å®šæ•°ã‚’exportã™ã‚‹éš›ã¯ã€äºˆæœŸã›ã¬ãƒã‚°ã‚’é˜²ããŸã‚ã«ã‚‚ã€`as const satisfies`ã‚’ä½¿ç”¨ã—ã¦ãŠã„ãŸã»ã†ãŒã„ã„ã€‚

## ã‚³ãƒ¼ãƒ‰ã§ã®æ´»ç”¨ä¾‹
```ts
const version = "1.0.0" as const satisfies `${number}.${number}.${number}`

const urlList = {
  apple: "https://www.apple.com/jp/",
  google: "https://www.google.com/",
  yahoo: "https://www.yahoo.co.jp/",
} as const satisfies {
  [key: string]: `https://${string}`
};
```

å‚è€ƒè¨˜äº‹
https://speakerdeck.com/tonkotsuboy_com/typescript-4-dot-9noas-const-satisfiesgabian-li-160d825b-7765-4c2b-945d-bb72cc389557
https://zenn.dev/tonkotsuboy_com/articles/typescript-as-const-satisfies

# namespace
## å‹ã«`.`ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚‚ã®
`React.FC`ã®ã‚ˆã†ã«`è¦ª.å‹å`ã§ã‚¢ã‚¯ã‚»ã‚¹ãŒã§ãã‚‹ã®ãŒ`namespace`ã®æ©Ÿèƒ½ã€‚
å‹ã‚’ã¾ã¨ã‚ã¦å®šç¾©ã—ã¦ãŠããŸã„ã¨ãã«ä¾¿åˆ©ã€‚
```ts
namespace Hoge {
  export type Fuga = string;
}

const test: Hoge.Fuga = 'hoge'; // OK
const test: Hoge.Fuga = 10; // NG  å‹ 'number' ã‚’å‹ 'string' ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
```

## namespaceã®æ›¸ãæ›ãˆ
ä¸‹è¨˜ã‚³ãƒ¼ãƒ‰ã§ã‚‚ä¸Šè¨˜ã§æ›¸ã„ãŸã‚³ãƒ¼ãƒ‰ã¨åŒã˜æ„å‘³ã«ãªã‚‹ã€‚
```ts:Hoge.ts
export type Fuga = string;
```
```ts
import type * as Hoge from 'Hoge.ts'

const test: Hoge.Fuga = 'hoge'; // OK
const test: Hoge.Fuga = 10; // NG  å‹ 'number' ã‚’å‹ 'string' ã«å‰²ã‚Šå½“ã¦ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚
```

## ã¾ã¨ã‚
`namespace`ã‚’ç™ºç”Ÿã•ã›ã‚‹ã«ã¯`namespace`ã‹`import *`ã®ã©ã¡ã‚‰ã‹ã€‚
å¥½ã¿ã®å•é¡Œã«ã¯ãªã‚‹ãŒã€å€‹äººçš„ã«ã¯`import *`ã§äº‹è¶³ã‚Šã‚‹ã‹ã¨ã€‚

å‚è€ƒè¨˜äº‹
https://zenn.dev/uhyo/articles/ts-namespace-2023
